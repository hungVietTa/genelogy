(self.webpackChunk=self.webpackChunk||[]).push([[237],{7434:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(3645),o=a.n(n)()((function(e){return e[1]}));o.push([e.id,".modal-dialog img,.my-gallery img{margin-bottom:20px;max-width:400px}@media screen and (max-width:600px){.btn{margin-bottom:10px;width:100%!important}}",""]);const l=o},7604:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});const n={props:{album:{type:Object,required:!0}},data:function(){return{form:{title:"",description:""},showModal:!1}},watch:{album:{immediate:!0,handler:function(){this.form.title=this.album.title,this.form.description=this.album.description}}},methods:{openModal:function(){this.showModal=!0},submitForm:function(){this.$emit("update-album",{id:this.album.id,albumData:this.form}),this.showModal=!1}}};const o=(0,a(1900).Z)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-button",{attrs:{variant:"info"},on:{click:e.openModal}},[e._t("default",(function(){return[e._v("Sửa đổi")]})),e._v(" "),a("b-modal",{attrs:{title:"Edit Album"},on:{ok:e.submitForm},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[a("b-form",[a("b-form-group",{attrs:{label:"Title","label-for":"title"}},[a("b-form-input",{attrs:{id:"title",required:""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("b-form-group",{attrs:{label:"Description","label-for":"description"}},[a("b-form-textarea",{attrs:{id:"description"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)],2)}),[],!1,null,null,null).exports},8124:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var n=a(7757),o=a.n(n),l=a(2060),i=a(8970),r=a(5156),s=a(9669),u=a.n(s),c=a(7604);function d(e,t,a,n,o,l,i){try{var r=e[l](i),s=r.value}catch(e){return void a(e)}r.done?t(s):Promise.resolve(s).then(n,o)}function m(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var l=e.apply(t,a);function i(e){d(l,n,o,i,r,"next",e)}function r(e){d(l,n,o,i,r,"throw",e)}i(void 0)}))}}const p={components:{VuePictureSwipe:r.Z,EditAlbum:c.Z},setup:function(e,t){var a=t.root,n=(0,l.f3)("vuex-store"),r=(0,l.Fl)((function(){return n.state.album.album})),s=(0,l.Fl)((function(){return r.value.images?r.value.images.map(w):[]})),c=(0,l.iH)(!1),d=(0,l.iH)(!1),p=(0,l.iH)(!1),f=(0,l.iH)([]),v=(0,l.iH)([]),b=(0,l.iH)([]);function h(){v.value=[],f.value.forEach((function(e){var t=new FileReader;t.onload=function(t){v.value.push({id:Math.random().toString(36).substr(2,9),src:t.target.result,name:e.name})},t.readAsDataURL(e)}))}function g(){return(g=m(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new FormData,f.value.forEach((function(e){t.append("images[]",e)})),e.prev=2,e.next=5,u().post("albums/".concat(r.value.id,"/images"),t,{headers:{"Content-Type":"multipart/form-data"}});case 5:n.dispatch("showAlbum",a.$route.params.id),c.value=!1,f.value=[],v.value=[],e.next=13;break;case 11:e.prev=11,e.t0=e.catch(2);case 13:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function w(e){return{src:e.url,thumbnail:e.url,w:1e3,h:800}}function _(){return(_=m(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.dispatch("deleteImages",b.value);case 2:n.dispatch("showAlbum",a.$route.params.id),p.value=!1;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,l.bv)((function(){return n.dispatch("showAlbum",a.$route.params.id)})),{album:r,items:s,imagePreviews:v,uploadModalOpen:c,deleteModalOpen:d,deleteImagesModalOpen:p,selectedFiles:f,selectedImages:b,showUploadModal:function(){c.value=!0},handleFileInputChange:function(e){f.value=Array.from(e.target.files),h()},generateImagePreviews:h,uploadImages:function(){return g.apply(this,arguments)},updateAlbum:function(e){n.dispatch("updateAlbum",e),n.dispatch("showAlbum",a.$route.params.id)},showDeleteModal:function(){d.value=!0},deleteAlbum:function(){n.dispatch("deleteAlbum",a.$route.params.id),i.Z.push("/albums"),d.value=!1},showDeleteImagesModal:function(){b.value=[],p.value=!0},deleteImages:function(){return _.apply(this,arguments)}}}};var f=a(3379),v=a.n(f),b=a(7434),h={insert:"head",singleton:!1};v()(b.Z,h);b.Z.locals;const g=(0,a(1900).Z)(p,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-card",{scopedSlots:e._u([{key:"header",fn:function(){return[a("b-row",{staticClass:"justify-content-between"},[a("div",[e._v(e._s(e.album.title))])])]},proxy:!0},{key:"footer",fn:function(){return[a("div",{staticClass:"d-flex align-items-center justify-content-around gx-5 flex-wrap album"},[a("b-button",{attrs:{variant:"info"},on:{click:e.showUploadModal}},[e._v("Thêm ảnh mới")]),e._v(" "),a("edit-album",{attrs:{album:e.album},on:{"update-album":e.updateAlbum}}),e._v(" "),a("b-button",{attrs:{variant:"info"}},[a("router-link",{staticClass:"text-white",attrs:{to:"/albums"}},[e._v("Quay lại")])],1),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:e.showDeleteModal}},[e._v("Xoá album")]),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:e.showDeleteImagesModal}},[e._v("Xoá ảnh")])],1)]},proxy:!0}])},[e._v(" "),a("vue-picture-swipe",{attrs:{items:e.items}})],1),e._v(" "),a("b-modal",{attrs:{title:"Add Images",size:"xl"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",[a("b-button",{attrs:{variant:"info"},on:{click:e.uploadImages}},[e._v("Xác nhận")]),e._v(" "),a("router-link",{staticClass:"btn btn-info",attrs:{to:"/albums"}},[e._v("Quay lại")])],1)]},proxy:!0}]),model:{value:e.uploadModalOpen,callback:function(t){e.uploadModalOpen=t},expression:"uploadModalOpen"}},[a("div",[a("input",{attrs:{type:"file",multiple:""},on:{change:e.handleFileInputChange}}),e._v(" "),e._l(e.imagePreviews,(function(e){return a("div",{key:e.id},[a("img",{attrs:{src:e.src,alt:e.name,width:"500",height:"300"}})])}))],2)]),e._v(" "),a("b-modal",{attrs:{title:"Confirm Delete"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",[a("b-button",{attrs:{variant:"primary"},on:{click:e.deleteAlbum}},[e._v("Đồng ý")]),e._v(" "),a("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.deleteModalOpen=!1}}},[e._v("Quay lại")])],1)]},proxy:!0}]),model:{value:e.deleteModalOpen,callback:function(t){e.deleteModalOpen=t},expression:"deleteModalOpen"}},[a("div",[e._v("Bạn có thực sự muốn xoá album này")])]),e._v(" "),a("b-modal",{attrs:{size:"xl",title:"Delete Images"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[a("div",[a("b-button",{attrs:{variant:"primary"},on:{click:e.deleteImages}},[e._v("Xác nhận")]),e._v(" "),a("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.deleteImagesModalOpen=!1}}},[e._v("Quay lại")])],1)]},proxy:!0}]),model:{value:e.deleteImagesModalOpen,callback:function(t){e.deleteImagesModalOpen=t},expression:"deleteImagesModalOpen"}},[a("div",e._l(e.album.images,(function(t){return a("div",{key:t.id},[a("label",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedImages,expression:"selectedImages"}],attrs:{type:"checkbox",width:"500",height:"300"},domProps:{value:t.id,checked:Array.isArray(e.selectedImages)?e._i(e.selectedImages,t.id)>-1:e.selectedImages},on:{change:function(a){var n=e.selectedImages,o=a.target,l=!!o.checked;if(Array.isArray(n)){var i=t.id,r=e._i(n,i);o.checked?r<0&&(e.selectedImages=n.concat([i])):r>-1&&(e.selectedImages=n.slice(0,r).concat(n.slice(r+1)))}else e.selectedImages=l}}})]),e._v(" "),a("img",{attrs:{src:t.url,alt:""}})])})),0)])],1)}),[],!1,null,null,null).exports}}]);